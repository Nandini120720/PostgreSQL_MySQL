Below is a **simple, DBA-friendly explanation of how to use indexes in PostgreSQL**, with **why, when, and how**, plus **real commands** (useful for interviews and production).

---

## 1Ô∏è‚É£ What is an Index in PostgreSQL?

An **index** is a separate data structure that helps PostgreSQL **find rows faster** without scanning the entire table.

üëâ Think of it like a **book index**: instead of reading every page, you jump directly to the topic.

---

## 2Ô∏è‚É£ When to Use an Index

Use an index when:

* Column is used in **WHERE**
* Column is used in **JOIN**
* Column is used in **ORDER BY**
* Column is used in **GROUP BY**
* Table is **large** and queries are slow

‚ùå Avoid index when:

* Table is very small
* Column changes frequently (heavy UPDATE/INSERT)
* Column has very few unique values (unless partial index)

---

## 3Ô∏è‚É£ Basic Index Syntax

```sql
CREATE INDEX index_name
ON table_name (column_name);
```

### Example

```sql
CREATE INDEX idx_emp_id
ON employees (emp_id);
```

---

## 4Ô∏è‚É£ How PostgreSQL Uses an Index (Verify)

Use **EXPLAIN ANALYZE**:

```sql
EXPLAIN ANALYZE
SELECT * FROM employees WHERE emp_id = 101;
```

‚úî You should see:

```text
Index Scan using idx_emp_id on employees
```

‚ùå Without index:

```text
Seq Scan on employees
```

---

## 5Ô∏è‚É£ Common Index Types (Very Important)

### üîπ 1. B-Tree Index (Default)

Used for:

* `=`
* `< > <= >=`
* `BETWEEN`
* `ORDER BY`

```sql
CREATE INDEX idx_salary
ON employees (salary);
```

üëâ **Most common index**

---

### üîπ 2. UNIQUE Index

Ensures no duplicate values.

```sql
CREATE UNIQUE INDEX idx_email
ON users (email);
```

(or created automatically with PRIMARY KEY / UNIQUE)

---

### üîπ 3. Composite (Multi-Column) Index

Used when filtering on **multiple columns**.

```sql
CREATE INDEX idx_emp_dept
ON employees (dept_id, emp_id);
```

‚ö† Rule:

```text
(dept_id, emp_id)
```

Works for:

* dept_id
* dept_id + emp_id
  ‚ùå Not for only emp_id

---

### üîπ 4. Partial Index (Very Important for Performance)

Index only **some rows**.

```sql
CREATE INDEX idx_active_users
ON users (user_id)
WHERE status = 'ACTIVE';
```

‚úî Smaller index
‚úî Faster queries

---

### üîπ 5. Expression Index

Used when query uses a function.

```sql
CREATE INDEX idx_lower_email
ON users (LOWER(email));
```

Query must match:

```sql
SELECT * FROM users WHERE LOWER(email) = 'abc@gmail.com';
```

---

### üîπ 6. GIN Index (JSON / Array / Full Text)

Used for:

* JSONB
* Arrays
* Full-Text Search

```sql
CREATE INDEX idx_json
ON orders
USING GIN (order_data);
```

---

### üîπ 7. BRIN Index (Huge Tables)

Used for **very large tables** (logs, time-series).

```sql
CREATE INDEX idx_log_time
ON logs
USING BRIN (created_at);
```

‚úî Very small
‚úî Best for sequential data

---

## 6Ô∏è‚É£ Index on Foreign Key (Best Practice)

Postgres **does NOT auto-create** index on FK.

```sql
CREATE INDEX idx_orders_customer
ON orders (customer_id);
```

---

## 7Ô∏è‚É£ How to Check Indexes

```sql
\d table_name
```

or

```sql
SELECT indexname, indexdef
FROM pg_indexes
WHERE tablename = 'employees';
```

---

## 8Ô∏è‚É£ Remove / Rebuild Index

### Drop Index

```sql
DROP INDEX idx_emp_id;
```

### Rebuild Index (No Lock)

```sql
REINDEX INDEX CONCURRENTLY idx_emp_id;
```

---

## 9Ô∏è‚É£ Index vs VACUUM

* **VACUUM** cleans dead rows inside index
* **Too many indexes = slow INSERT/UPDATE**

‚úî Balance is important

---

## üîü Interview-Ready Summary

‚úî Index speeds up SELECT
‚úî Uses extra disk space
‚úî Slows INSERT/UPDATE
‚úî Always validate using `EXPLAIN ANALYZE`
‚úî B-Tree is default
‚úî Partial & composite indexes are performance gold

---

If you want, next I can explain:

* **Why index is not used sometimes**
* **Index vs Seq Scan**
* **Index in MVCC**
* **Real production tuning examples**

Just tell me üëç
